KISSY.add("gallery/kcharts/1.0/basechart/index",function(j,o){var p=j.all,l=function(){};j.extend(l,o,{init:function(a){var d;if(a&&a.renderTo&&(d=this._cfg=j.mix({zIndex:0,yAxis:{},canvasAttr:{x:60,y:60},defineDataKey:{}},a),this._$ctnNode=p(a.renderTo),this.getInnerContainer(),j.mix(this,{_datas:{cur:{},total:{}},_points:{},_centerPoints:[],_pointsX:[],_pointsY:[],_gridsX:[],_gridsY:[],_stocks:[],_areas:[],_axisX:null,_axisY:null,_labelX:[],_labelY:[],_evtEls:[],_multiple:!1}),d.series&&!(0>=d.series.length)&&
d.series[0].data)){1<d.series.length&&(this._multiple=!0);for(var c in d.series)this._datas.total[c]={index:c,data:d.series[c].data},this._datas.cur[c]={index:c,data:d.series[c].data};this.dataFormat()}},removeData:function(a){delete this._datas.cur[a];this.dataFormat()},recoveryData:function(a){this._datas.cur[a]=this._datas.total[a];this.dataFormat()},getInnerContainer:function(){var a=this._$ctnNode,d=j.mix(this._cfg.canvasAttr),c=d.width||a.width()-2*d.x,a=d.height||a.height()-2*d.y,e=d.x,d=d.y;
return this._innerContainer={x:e,y:d,width:c,height:a,tl:{x:e,y:d},tr:{x:e+c,y:d},bl:{x:e,y:d+a},br:{x:e+c,y:d+a}}},dataFormat:function(){var a=this._cfg,d=[],c;for(c in this._datas.cur){var e=this.getArrayByKey(this._datas.cur[c].data,a.defineKey.y);d.push(e.join(","))}var d=d.join(",").split(","),e=this._innerContainer.x,f=a.yAxis.num||5,g=Math.max.apply(null,d),d=Math.min.apply(null,d),i=0.1*(g-d),f=this.coordNum=this.getScales(a.yAxis.max||0==a.yAxis.max?a.yAxis.max:g+i,a.yAxis.min||0==a.yAxis.min?
a.yAxis.min:d-i,f),g=this.data2GrapicData(f);this._pointsY=[];this._centerPoints=[];this.data2GrapicData(g);for(c in g)this._pointsY[c]={number:f[c]+"",y:g[c],x:e};for(c in this._datas.cur)this._points[c]=this.getDataPoints(this._datas.cur[c].data);if(this._points[0]&&1<this._points[0].length){var h=h?h:this._points[0][1].x-this._points[0][0].x;for(c in this._points[0])this._centerPoints[c]={x:this._points[0][c].x-h/2,y:0};this._centerPoints.push({x:this._points[0][a.xAxis.text.length-1].x- -h/2,
y:0})}},data2GrapicData:function(a){if(a){var d=this._innerContainer,c=d.y,d=d.height,e=Math.max.apply(null,this.coordNum),f=Math.min.apply(null,this.coordNum),g=[];if(a.length){for(var i in a)g.push(d*(1-(a[i]-f)/(e-f))+c);return g}return d*(1-(a-f)/(e-f))+c}},getSplitPoints:function(a,d,c,e,f,g){var c=(c-a)/f,e=(e-d)/f,i=[];g&&i.push({x:a,y:d});for(var h=0;h<f-1;h++)i.push({x:a+(h+1)*c,y:d+(h+1)*e});g&&i.push({x:a,y:d});return i},getScales:function(a,d,c){var e,f;e=Math.log;f=Math.pow;var g=[];
if(!(a<=d)){c=(a-d)/c;e=Math.floor(e(c)/e(10))+1;c/=f(10,e);f=(0<c&&0.1>=c?0.1:0.1<c&&0.2>=c?0.2:0.2<c&&0.25>=c?0.25:0.25<c&&0.5>=c?0.5:1)*f(10,e);for(e=c=(a+d)/2-(a+d)/2%f;e>d;)e-=f;for(;c<a;)c+=f;for(a=e;a<=c;a+=f)g.push(a);return g}},arraySort:function(a,d,c){return a.sort(function(a,f){return d?"object"==typeof a&&"object"==typeof f?f[c]-a[c]:f-a:"object"==typeof a&&"object"==typeof f?a[c]-f[c]:a-f})},getArrayByKey:function(a,d){var c=[],e;for(e in a)a[e][d]&&c.push(a[e][d]);return c},obj2Array:function(a,
d){var c=[],e;for(e in a)c.push(d?a[d]:a[e]);return c},getObjKeys:function(a){var d=[];for(b in a)d.push(b);return d},getDataPoints:function(a){var d=this._cfg,c=this._innerContainer,e=c.x,f=c.y,g=c.width,c=c.height,i=Math.max.apply(null,this.coordNum),h=Math.min.apply(null,this.coordNum),j=d.defineKey,l=j.x||"",j=j.y||"",n=[],m=0;this._pointsX=this.getSplitPoints(e,f+c,e+g,f+c,(d.xAxis.text.length||0)+1);for(var k in this._pointsX)d.xAxis.text[k]==a[m][l]?(n[k]={x:this._pointsX[k].x,y:c*(1-(a[m][j]-
h)/(i-h))+f,dataInfo:a[m],index:Math.round(k)},m++):n[k]={x:this._pointsX[k].x,index:Math.round(k)};return n}});return l},{requires:["base"]});
