KISSY.add("gallery/scrollspy/1.0/index",function(c){function f(a){this.init(a);this.refresh()}var e=c.all,g=c.one;c.augment(f,{constructor:f,refresh:function(){this.targets=[];this.offsets=[];e(this.navSelector).each(function(a){var a=a.attr("data-href"),b=g(a);/^#\w/.test(a)&&b.length&&(this.targets.push(a),this.offsets.push(b.offset().top))},this)},process:function(){var a=this.$scrollElement.scrollTop()+this.offset,b=this.offsets,c=this.targets,e=this.activeTarget,d,a=a+b[0];for(d=b.length;d--;)e!=
c[d]&&a>=b[d]&&(!b[d+1]||a<=b[d+1])&&this.activate(c[d])},activate:function(a){var b;this.activeTarget=a;(b=e(".active",this.navContainer))&&b.removeClass("active");e(this.activerSelector+":has([data-href="+a+"])").addClass("active")},init:function(a){this.offset=a.offset;this.navSelector=a.navSelector;this.navContainer=a.navContainer;this.activerSelector=a.activerSelector;var b=c.bind(this.process,this);this.$scrollElement=e(a.scrollArea).on("scroll",b)}});return f},{requires:["sizzle"]});
