KISSY.add("gallery/province/1.0/index",function(f){function h(a,b,c){var e=this;e.config=f.merge(k,c||{});e.selManager=new l;e.data=b;f.each(a,function(a,b){if(a=j.get(a))e.selManager.add(a,b),m.on(a,"change",function(a){e._change(a)})});if(!0==e.config.autoRender&&(a=e.selManager.get(0)))e._render(a,c.rootid),e.selManager.get(1)&&e.focus(a[0],e.getValue(a[0]))}function l(){var a=[];this.add=function(b,c){var e=a.length;a[e]={index:c,"0":b,data:{}};return a[e]};this.get=function(b){var c=null;if(f.isNumber(b)&&
b<=a.length)return a[b];f.each(a,function(a){if(a["0"]==b)return c=a,!1});return c}}var j=f.DOM,m=f.Event,k={autoRender:!0,defval:{text:"\u8bf7\u9009\u62e9",val:""},rootid:0};f.augment(h,f.EventTarget,{getValue:function(a){return a&&a.options&&0<a.options.length&&0<a.selectedIndex?a.options[a.selectedIndex].value:null},_forward:function(a,b){var c=this.selManager.get(a);if(c&&(c=this.selManager.get(c.index+1)))this._render(c,b),this._forward(c[0],this.getValue(c[0]))},_backward:function(a,b){pid=this.data[b]?this.data[b][1]:
null;if((forwardEl=this.selManager.get(a))&&pid){var c=this.selManager.get(forwardEl.index-1),e=this.data[pid]?this.data[pid][1]:null;c&&pid&&(this._render(c,e,pid),this._backward(c[0],this.getValue(c[0])))}},_change:function(a){a=a.target;this.selManager.get(a);this._forward(a,j.val(a))},_getData:function(a,b){var c=this,e=c.config.remote,g=[];if(!(-1===b||""===b||!a.data)){if(a.data[b])return a.data[b];var i=a.data[b]=[];if(e){if(0===b&&0<c.data.length)return;f.io({type:"POST",url:e.url,dataType:"json",
data:{parent:b},success:function(e){f.each(e.data,function(a){i.push([a[1],a[0]])});c._render(a,b)},error:function(a,b,c){f.log(d,b,c)}})}f.each(c.data,function(a,c){a[1]==b&&(i.push([c,a[0]]),g.push([c,a[0]]))});return g}},_render:function(a,b,c){var e=this.config,g=a["0"],a=this._getData(a,b)||[];g&&(g.options.length=0,a&&0<a.length&&e.defval&&(g.options[g.options.length]=new Option(e.defval.text,e.defval.val)),f.each(a,function(a){g.options[g.options.length]=new Option(a[1],a[0])}),c&&(g.value=
c))},focus:function(a,b){var c=this.selManager.get(a),e=this.data[b]?this.data[b][1]:null;e&&(this._render(c,e,b),this._forward(a,b),this._backward(a,b))}});return h});
