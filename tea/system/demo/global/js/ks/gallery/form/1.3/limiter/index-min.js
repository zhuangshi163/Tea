KISSY.add("gallery/form/1.3/limiter/index",function(d,g,h){function c(a,b){b=d.merge({target:f(a)},b);c.superclass.constructor.call(this,b)}var f=g.all;d.mix(c,{tpl:{DEFAULT:'<span class="ks-letter-count">你还可以输入<em class="J_LetterRemain">{remain}</em>个汉字</span>'},event:{RENDER:"render",COUNT:"count"}});d.extend(c,h,{render:function(){var a=this,b=a.get("target");if(!b.length)return!1;a.set("tpl",a.get("defaultTpl"));a.count();b.on("keyup blur",function(){a.count()});a.fire(c.event.RENDER)},count:function(){var a=
this.get("len"),b=this.get("max"),e=this.get("defaultTpl"),d=this.get("exceedTpl"),a=a>b&&d||e;this.get("isCut")&&(a=e,this._cutText());this.set("tpl",a);this._create();this.fire(c.event.COUNT)},_cutText:function(){if(!this.get("isCut"))return!1;var a=this.get("len"),b=this.get("max"),e=this.get("target");a>b&&(a=e.val(),a=a.substr(0,b),e.val(a))},_create:function(){var a=this.get("wrapper"),b=this.get("target"),e=this.get("tpl"),c=this.get("max"),f=this.get("len");if(!b.length)return!1;b=d.substitute(e,
{len:f,max:c,remain:Math.abs(c-f)});a.html(b)}},{ATTRS:{wrapper:{value:"",getter:function(a){return f(a)}},target:{value:""},el:{value:""},tpl:{value:""},defaultTpl:{value:'<span class="ks-letter-count">你还可以输入<em class="J_LetterRemain">{remain}</em>个汉字</span>'},exceedTpl:{value:'<span class="ks-letter-count">已经超出<em class="J_LetterRemain exceed-letter">{remain}</em>个汉字</span>'},max:{value:50},len:{value:0,getter:function(){var a=this.get("target"),a=d.trim(a.val()),b=this.get("isRejectTag"),c=this.get("isEnToCn");
b&&(a=a.replace(/<[^>]*>/g,""));b=a.length;c&&(a=a.replace(/[^\x00-\xff]/g,"**"),b=Math.ceil(a.length/2));return b}},isRejectTag:{value:!1},isEnToCn:{value:!1},isCut:{value:!1}}});return c},{requires:["node","base"]});
